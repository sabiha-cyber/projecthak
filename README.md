
---

## Feature Implementation Breakdown

### 1. User Authentication and Session Management

- Implemented in **`sign.py`**.
- Uses Firebase Admin SDK for backend authentication.
- On app start (**`main.py`**), users are authenticated and their roles (`student` or `admin`) are loaded from Firestore into `st.session_state`.
- Suspended users are checked via a `suspended` flag and prevented from using the app.
- User session state maintains the current username, role, and suspension status to control UI and access dynamically.

---

### 2. Marketplace Listings (`market.py`)

- Listings data are stored locally in a CSV file (`listing.csv`) to avoid complex database writes for every new post.
- On startup, `init_csv()` checks if `listing.csv` exists; if not, it creates an empty CSV with predefined columns.
- Students create listings via a Streamlit form, selecting:
  - Listing type: Tangible Item or Service
  - Categories/subcategories (e.g., Textbook, Gadgets, Tutoring)
  - Condition for items or service type for services
  - Title and description
  - Pricing model: Fixed Price, Hourly Rate, or Bidding
  - Price or minimum bid depending on model
  - Visibility restrictions (e.g., university-only)
  - University name
- On submission, a new listing dictionary is appended to the CSV via `add_listing()`.
- Listings have unique IDs generated by incrementing the row count in the CSV.

---

### 3. AI Price Recommendation (`chatbot.py`)

- Integrated with the listing form via an **"Ask AI For Price Recommendations"** button.
- The `price_advice(title)` function sends the listing title to an AI-powered service (such as OpenAI) that returns recommended prices.
- This feature helps users price their items realistically before publishing.

---

### 4. User Reviews and Ratings

- Users can submit ratings (1 to 5) and comments about transactions with other users.
- Reviews are stored in `st.session_state.reviews` as a list of dictionaries containing `from`, `to`, `rating`, and `comment`.
- Admins monitor reviews and identify users with multiple low ratings for possible suspension.

---

### 5. Admin Controls (`admin.py`)

- The admin panel allows admins to:
  - View and moderate **pending listings**, approving or rejecting them.
  - View all user reviews, highlighting poor reviews (ratings â‰¤ 2).
  - Flag users with two or more poor reviews and suspend them by toggling the suspended flag in session state.
  - View detailed user profile information (DOB, phone number) fetched on-demand from Firestore.
- The suspension mechanism immediately restricts user access on login.

---

### 6. User Profile Management

- User profiles are cached locally in JSON (`student_profile.json`) and fetched live from Firestore as needed.
- Profiles include personal details such as date of birth and phone number.
- Users can view and potentially edit their profile information via the UI.

---

### 7. Session State & Persistence

- The app uses **`st.session_state`** extensively to maintain:
  - Logged-in user information
  - Loaded users dictionary with roles and suspension flags
  - Current marketplace listings (pending and approved)
  - User reviews
- This approach reduces database calls and keeps data in memory for performance but requires periodic syncing or app restarts to refresh data.
- Marketplace listings are persisted locally in `listing.csv` to ensure data remains across sessions.

---

## Data Management

| Data Type             | Storage Location          | Description                           |
|-----------------------|--------------------------|-------------------------------------|
| Users & Roles         | Firebase Firestore       | Authentication and role management  |
| Marketplace Listings  | Local CSV (`listing.csv`)| Listing data persisted locally       |
| User Reviews          | Streamlit Session State  | In-memory reviews during runtime     |
| User Profiles         | Firestore + Local JSON   | Profile details cached and live fetched|

---

## Authentication & User Roles

- Firebase Authentication validates user credentials and sessions.
- User roles are retrieved from Firestore (`student` or `admin`).
- A `suspended` flag in Firestore controls access restrictions.
- Role and suspension status dictate available UI components and permissions.

---
## Block payment system:
- Secured payment through block chain technology using infuro

## Wishlist:
- Added a wishlist in marketplace
## How to Run

1. Clone the repository:

   ```bash
   git clone https://github.com/sabiha-cyber/projecthak.git
   cd projecthak
